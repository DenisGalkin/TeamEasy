<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
    <h3 style="margin: 0;">{{ task.title }}</h3>
    <button onclick="closeModal('taskModal')"
            style="background: none; border: none; font-size: 1.5rem; cursor: pointer;">×
    </button>
</div>

<form method="POST" action="{{ url_for('update_task', project_id=project_id, task_id=task.id) }}">
    <div class="form-group">
        <label for="title">Название</label>
        <input type="text" id="title" name="title" class="form-control" value="{{ task.title }}" required>
    </div>

    <div class="form-group">
        <label for="description">Описание</label>
        <textarea id="description" name="description" class="form-control"
                  rows="4">{{ task.description or '' }}</textarea>
    </div>

    <div class="grid grid-cols-2" style="gap: 1rem;">
        <div class="form-group">
            <label for="status">Статус</label>
            <select id="status" name="status" class="form-control">
                <option value="todo" {% if task.status == 'todo' %}selected{% endif %}>Нужно сделать</option>
                <option value="in_progress" {% if task.status == 'in_progress' %}selected{% endif %}>В работе</option>
                <option value="done" {% if task.status == 'done' %}selected{% endif %}>Выполнено</option>
            </select>
        </div>

        <div class="form-group">
            <label for="priority">Приоритет</label>
            <select id="priority" name="priority" class="form-control">
                <option value="low" {% if task.priority == 'low' %}selected{% endif %}>Низкий</option>
                <option value="medium" {% if task.priority == 'medium' %}selected{% endif %}>Средний</option>
                <option value="high" {% if task.priority == 'high' %}selected{% endif %}>Высокий</option>
            </select>
        </div>
    </div>

    <div class="grid grid-cols-2" style="gap: 1rem;">
        <div class="form-group">
            <label for="due_date">Срок выполнения</label>
            <input type="date" id="due_date" name="due_date" class="form-control"
                   value="{{ task.due_date.strftime('%Y-%m-%d') if task.due_date else '' }}">
        </div>

        <div class="form-group">
            <label for="assignee">Назначить на</label>
            <select id="assignee" name="assignee" class="form-control">
                <option value="">Не назначена</option>
                {% for member in members %}
                    <option value="{{ member.user.id }}" {% if task.assigned_to == member.user.id %}selected{% endif %}>
                        {{ member.user.username }}
                    </option>
                {% endfor %}
            </select>
        </div>
    </div>

    <div style="display: flex; gap: 1rem; margin-top: 2rem;">
        <button type="submit" class="btn">Сохранить</button>
        <button type="button" class="btn btn-outline" onclick="closeModal('taskModal')">Отмена</button>
    </div>
</form>

<div style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid var(--border-color);">
    <form method="POST" action="{{ url_for('delete_task', project_id=project_id, task_id=task.id) }}"
          onsubmit="return confirm('Вы уверены, что хотите удалить эту задачу?')"
          style="margin-top: 1rem;">
        <button type="submit" class="btn" style="background: #dc3545; width: 100%;">Удалить задачу</button>
    </form>
</div>